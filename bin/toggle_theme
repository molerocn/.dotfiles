#!/bin/bash

MODE=$1  # Primer argumento: "manual" o "automatic"
CONFIG_FILE="$HOME/.config/alacritty/alacritty.toml"

restart_anki() {
    if pgrep -x "anki" > /dev/null; then
        pkill -9 anki
        sleep 1
        anki &
    fi
}

set_light() {
    sed -i 's/github_dark_default/github_light/' "$CONFIG_FILE"
    gsettings set org.gnome.desktop.interface color-scheme 'prefer-light'
    restart_anki
    echo "ðŸŒž Light mode activado"
}

set_dark() {
    sed -i 's/github_light/github_dark_default/' "$CONFIG_FILE"
    gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'
    restart_anki
    echo "ðŸŒ™ Dark mode activado"
}

if [[ "$MODE" == "manual" ]]; then
    current_scheme=$(gsettings get org.gnome.desktop.interface color-scheme)
    if [[ "$current_scheme" == "'prefer-dark'" ]]; then
        set_light
    else
        set_dark
    fi
elif [[ "$MODE" == "automatic" ]]; then
    hour=$(date +%H)
    if (( hour >= 8 && hour < 17 )); then
        set_light
    else
        set_dark
    fi
else
    echo "Uso: $0 [manual|automatic]"
    exit 1
fi

